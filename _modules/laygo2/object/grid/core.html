
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>laygo2.object.grid.core &#8212; laygo2</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/autoclasstoc.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../index.html">
  <img src="../../../../_static/logo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../overview.html">
  Overview
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../trial.html">
  Trial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../laygo2.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../technology.html">
  Tech Setup
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../resources.html">
  Resources
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../../kor.html">
  Korean
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/niftylab/laygo2" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for laygo2.object.grid.core</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1">########################################################################################################################</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2020, Nifty Chips Laboratory, Hanyang University</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without modification, are permitted provided that the</span>
<span class="c1"># following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># 1. Redistributions of source code must retain the above copyright notice, this list of conditions and the following</span>
<span class="c1">#   disclaimer.</span>
<span class="c1"># 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the</span>
<span class="c1">#    following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,</span>
<span class="c1"># INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c1"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,</span>
<span class="c1"># WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">#</span>
<span class="c1">########################################################################################################################</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">**laygo2.object.grid** module contains classes that implement abstract coordinate systems that are interacting with technology-specific physical coordinate systems.</span>

<span class="sd">laygo2 implements the layout designs based on the abstract coordinate system.</span>

<span class="sd">.. image:: ../assets/img/user_guide_grid.png</span>



<span class="sd">Check the following links for the details of component classes.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;Jaeduk Han&quot;</span>
<span class="n">__maintainer__</span> <span class="o">=</span> <span class="s2">&quot;Jaeduk Han&quot;</span>
<span class="n">__status__</span> <span class="o">=</span> <span class="s2">&quot;Prototype&quot;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">laygo2.object</span>

<span class="c1"># import laygo2.util.conversion as cv</span>


<span class="c1"># Internal functions.</span>
<span class="k">def</span> <span class="nf">_extend_index_dim</span><span class="p">(</span><span class="n">input_index</span><span class="p">,</span> <span class="n">new_index</span><span class="p">,</span> <span class="n">new_index_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper function to be used for the multi-dimensional circular array</span>
<span class="sd">    indexing of CircularMappingArray. It extends the dimension of the input</span>
<span class="sd">    array (input_index) that contains indexing information, with the</span>
<span class="sd">    additional indexing variable (new_index) provided. The new_index_max</span>
<span class="sd">    variable is specified in case of the new_index does not contain the</span>
<span class="sd">    maximum index information (perhaps when an open-end slice is given for</span>
<span class="sd">    the new_index).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    input_index : iterable</span>
<span class="sd">        The iterable object to be extended.</span>
<span class="sd">    new_index : iterable</span>
<span class="sd">        The iterable object to be added to input_ind to extend its dimension.</span>
<span class="sd">    new_index_max : iterable</span>
<span class="sd">        The maximum index of new_index when its upper boundary is not</span>
<span class="sd">        provided.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Iterable</span>
<span class="sd">        The extended index.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import laygo2</span>
<span class="sd">    &gt;&gt;&gt; # 0-dim to 1-dim</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._extend_index_dim(None, [3, 4, 6], None)</span>
<span class="sd">    [(3,), (4,), (6,)]</span>
<span class="sd">    &gt;&gt;&gt; # 0-dim to 1-dim (with slicing input)</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._extend_index_dim(None, slice(3, 8, 2), None)</span>
<span class="sd">    [(3,), (5,), (7,)]</span>
<span class="sd">    &gt;&gt;&gt; # 0-dim to 1-dim, with maximum index given</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._extend_index_dim(None, slice(3, None, 2), 8)</span>
<span class="sd">    [(3,), (4,), (6,)]</span>
<span class="sd">    &gt;&gt;&gt; # 1-dim to 2-dim</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._extend_index_dim([(3,), (4,), (6,)], [1, 2], None)</span>
<span class="sd">    [[(3, 1), (3, 2)], [(4, 1), (4, 2)], [(6, 1), (6, 2)]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Construct an iterator from new_index</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_index</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
        <span class="n">it</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_index</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="c1"># slices don&#39;t work very well with multi-dimensional circular mappings.</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">_conv_slice_to_list</span><span class="p">(</span><span class="n">slice_obj</span><span class="o">=</span><span class="n">new_index</span><span class="p">,</span> <span class="n">stop_def</span><span class="o">=</span><span class="n">new_index_max</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">it</span> <span class="o">=</span> <span class="n">new_index</span>
    <span class="c1"># Index extension</span>
    <span class="k">if</span> <span class="n">input_index</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">output</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">input_index</span><span class="p">:</span>
            <span class="n">output_row</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">it</span><span class="p">:</span>
                <span class="n">output_row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">_i</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">_conv_slice_to_list</span><span class="p">(</span><span class="n">slice_obj</span><span class="p">,</span> <span class="n">start_def</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop_def</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step_def</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert slice to a list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    slice_obj : slice</span>
<span class="sd">        The slice object to be converted.</span>
<span class="sd">    start_def : int, optional</span>
<span class="sd">        The default starting index if the slice object has no lower boundary.</span>
<span class="sd">    stop_def : int, optional</span>
<span class="sd">        The default stopping index if the slice object has no upper boundary.</span>
<span class="sd">    step_def : int, optional</span>
<span class="sd">        The default stepping index if the slice object has no step specified.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import laygo2</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._conv_slice_to_list(slice(0, 10, 2))</span>
<span class="sd">    [0, 2, 4, 6, 8]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">start_def</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">start</span>
    <span class="k">if</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">stop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">stop_def</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">stop</span> <span class="o">=</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">stop</span>
    <span class="k">if</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">step_def</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">slice_obj</span><span class="o">.</span><span class="n">step</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">stop</span><span class="p">,</span> <span class="n">step</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">_conv_bbox_to_array</span><span class="p">(</span><span class="n">bbox</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a bbox object to a 2-d array.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox : numpy.ndarray</span>
<span class="sd">        The bounding box to be converted.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import laygo2</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._conv_bbox_to_array(np.array([[0, 0], [1, 2]]))</span>
<span class="sd">    array([[[0, 0], [1, 0]],</span>
<span class="sd">           [[0, 1], [1, 1]],</span>
<span class="sd">           [[0, 2], [1, 2]]])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">])</span>
        <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_conv_bbox_to_list</span><span class="p">(</span><span class="n">bbox</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert a bbox object to a 1-d list.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bbox : numpy.ndarray</span>
<span class="sd">        The bounding box to be converted.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; import laygo2</span>
<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; laygo2.object.grid._conv_bbox_to_list(np.array([[0, 0], [1, 2]]))</span>
<span class="sd">    [[0, 0], [1, 0], [0, 1], [1, 1], [0, 2], [1, 2]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">array</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">array</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">array</span>


<span class="c1"># External functions</span>
<div class="viewcode-block" id="copy"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.copy">[docs]</a><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Copy a grid object.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span></div>

<div class="viewcode-block" id="vflip"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.vflip">[docs]</a><span class="k">def</span> <span class="nf">vflip</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flip a grid object in vertical direction.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="hflip"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.hflip">[docs]</a><span class="k">def</span> <span class="nf">hflip</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Flip a grid object in horizontal direction.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="vstack"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.vstack">[docs]</a><span class="k">def</span> <span class="nf">vstack</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stack routing grid(s) on top of the routing grid in vertical direction.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="hstack"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.hstack">[docs]</a><span class="k">def</span> <span class="nf">hstack</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Stack routing grid(s) on top of the routing grid in horizontal direction.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>


<span class="c1"># Internal classes</span>
<div class="viewcode-block" id="CircularMapping"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping">[docs]</a><span class="k">class</span> <span class="nc">CircularMapping</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic circular mapping class (index number expands infinitely).</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import Circularmapping</span>
<span class="sd">    &gt;&gt;&gt; map = CircularMapping(elements=[100, 200, 300])</span>
<span class="sd">    &gt;&gt;&gt; print(map[0])</span>
<span class="sd">    100</span>
<span class="sd">    &gt;&gt;&gt; print(map[2])</span>
<span class="sd">    300</span>
<span class="sd">    &gt;&gt;&gt; print(map[4])</span>
<span class="sd">    200</span>
<span class="sd">    &gt;&gt;&gt; print(map[-3])</span>
<span class="sd">    100</span>
<span class="sd">    &gt;&gt;&gt; print(map[[2, 3, -2])</span>
<span class="sd">    [300, 100, 200]</span>
<span class="sd">    &gt;&gt;&gt; print(map[2:7])</span>
<span class="sd">    [300, 100, 200, 300, 100]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 기본 순환 맵핑 (인덱싱 넘버가 무한히 확장) 클래스.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_elements</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;list: Array consisting of the elements of circular mapping.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import CircularMapping</span>
<span class="sd">    &gt;&gt;&gt; elements = [0, 35, 85, 130, 180] </span>
<span class="sd">    &gt;&gt;&gt; cm = CircularMapping(elements) </span>
<span class="sd">    &gt;&gt;&gt; cm.elements</span>
<span class="sd">    [0, 35, 85, 130, 180]</span>

<span class="sd">    .. image:: ../assets/img/object_grid_CircularMapping_elements.png</span>
<span class="sd">           :height: 250 </span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)**</span>
<span class="sd">    순환 맵핑의 구성 요소로 이루어진 배열. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span>
    <span class="sd">&quot;&quot;&quot;type: Data type of the circular mapping.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import CircularMapping</span>
<span class="sd">    &gt;&gt;&gt; elements = [0, 35, 85, 130, 180] </span>
<span class="sd">    &gt;&gt;&gt; cm = CircularMapping(elements) </span>
<span class="sd">    &gt;&gt;&gt; cm.dtype</span>
<span class="sd">    int</span>

<span class="sd">    .. image:: ../assets/img/object_grid_CircularMapping_dtype.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)**</span>
<span class="sd">    순환 맵핑의 데이터 유형.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="CircularMapping.get_elements"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.get_elements">[docs]</a>    <span class="k">def</span> <span class="nf">get_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: getter of elements.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span></div>

<div class="viewcode-block" id="CircularMapping.set_elements"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.set_elements">[docs]</a>    <span class="k">def</span> <span class="nf">set_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: setter of elements.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>

    <span class="n">elements</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_elements</span><span class="p">,</span> <span class="n">set_elements</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;numpy.ndarray: the array that contains the physical coordinates of the grid.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: The shape of circular mapping.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import CircularMapping</span>
<span class="sd">        &gt;&gt;&gt; elements = [0, 35, 85, 130, 180]</span>
<span class="sd">        &gt;&gt;&gt; cm = CircularMapping(elements)</span>
<span class="sd">        &gt;&gt;&gt; cm.shape</span>
<span class="sd">        array([5])</span>

<span class="sd">        .. image:: ../assets/img/object_grid_CircularMapping_shape.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)**</span>
<span class="sd">        순환 맵핑의 shape.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<div class="viewcode-block" id="CircularMapping.__init__"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor function of CircularMapping class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        elements : list</span>
<span class="sd">            elements.</span>
<span class="sd">        dtype : type</span>
<span class="sd">            data type of elements.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import CircularMapping</span>
<span class="sd">        &gt;&gt;&gt; elements = [0, 35, 85, 130, 180]</span>
<span class="sd">        &gt;&gt;&gt; cm = CircularMapping(elements)</span>
<span class="sd">        &gt;&gt;&gt; cm.shape</span>
<span class="sd">        [5]</span>
<span class="sd">        &gt;&gt;&gt; cm[5]</span>
<span class="sd">        35</span>
<span class="sd">        &gt;&gt;&gt; cm[0:10]</span>
<span class="sd">        [0, 35, 85, 130, 0, 35, 85, 130, 0, 35]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_CircularMapping_init.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** CircularMapping 클래스의 생성자함수</span>
<span class="sd">            파라미터</span>
<span class="sd">            - elements(list): 구성 요소</span>
<span class="sd">            - dtype(type): 구성 요소의 datatype</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span></div>

    <span class="c1"># indexing and slicing</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Element access function of circular mapping.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">pos</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">_conv_slice_to_list</span><span class="p">(</span><span class="n">slice_obj</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">stop_def</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;CircularMapping received an invalid index:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>

    <span class="c1"># Iterators</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Iteration function of circular mapping.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Next element access function of circular mapping.&quot;&quot;&quot;</span>
        <span class="c1"># Check if numpy.ndarray implements __next__()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()</span>

    <span class="c1"># Informative functions</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize</span><span class="p">()</span>

<div class="viewcode-block" id="CircularMapping.summarize"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.summarize">[docs]</a>    <span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the summary of the object information.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="s2">&quot;class: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="s2">&quot;elements: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span></div>

    <span class="c1"># Regular member functions</span>
<div class="viewcode-block" id="CircularMapping.append"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append elements to the mapping.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="o">+</span> <span class="n">elem</span><span class="p">)</span></div>

<div class="viewcode-block" id="CircularMapping.flip"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flip the elements of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

<div class="viewcode-block" id="CircularMapping.copy"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">CircularMapping</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="CircularMapping.concatenate"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMapping.concatenate">[docs]</a>    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">elements</span><span class="p">))</span></div></div>
        <span class="c1">#for e in elements:</span>
        <span class="c1">#    self.elements = np.concatenate((self.elements, obj.elements))</span>
        <span class="c1">#self.range[1] += obj.range[1] - obj.range[0]</span>



<div class="viewcode-block" id="CircularMappingArray"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMappingArray">[docs]</a><span class="k">class</span> <span class="nc">CircularMappingArray</span><span class="p">(</span><span class="n">CircularMapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multi-dimensional circular mapping class (index number expands infinitely).</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 다차원 순환맵핑(인덱싱 넘버가 무한히 확장) 클래스.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Element access function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos : int</span>
<span class="sd">            index number being accessed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import CircularMappingArray</span>
<span class="sd">        &gt;&gt;&gt; elements = [[0, 0], [35, 0], [85, 0], [130, 0]]</span>
<span class="sd">        &gt;&gt;&gt; cm = CircularMappingArray(elements = elements)</span>
<span class="sd">        &gt;&gt;&gt; cm[1, :]</span>
<span class="sd">        array([[35, 0]])</span>
<span class="sd">        &gt;&gt;&gt; cm[3, 0]</span>
<span class="sd">        130</span>

<span class="sd">        .. image:: ../assets/img/object_grid_CircularMappingArray_getitem.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 순환 맵핑의 요소 접근함수</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>  <span class="c1"># pos is containing multiple indices as a list</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])):</span>
            <span class="c1"># pos is mapped to a single element (pos is composed of integer indices).</span>
            <span class="c1"># just do rounding.</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                <span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span> <span class="o">%</span> <span class="n">s</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># pos is mapped to multiple indices. (possible Example include ([0:5, 3], [[1,2,3], 3], ...).</span>
            <span class="c1"># Create a list containing the indices to iterate over, and return a numpy.ndarray containing items</span>
            <span class="c1"># corresponding to the indices in the list.</span>
            <span class="c1"># When the indices don&#39;t specify the lower boundary (e.g., [:5]), it iterates from 0.</span>
            <span class="c1"># When the indices don&#39;t specify the upper boundary (e.g., [3:]), it iterates to the maximum index defined.</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>  <span class="c1"># iterate over input indices (x and y).</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">_extend_index_dim</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="c1"># iterate and generate the list to return</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">idx</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># -1 because the tuples in idx are flatten.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">_null</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
                <span class="n">item</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">idx</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    
    <span class="c1"># Regular member functions</span>
<div class="viewcode-block" id="CircularMappingArray.flip"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMappingArray.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flip the elements of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span></div>

<div class="viewcode-block" id="CircularMappingArray.copy"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.CircularMappingArray.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">CircularMappingArray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_AbsToPhyGridConverter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An internal class that converts abstract coordinates into physical</span>
<span class="sd">    coordinates. Conversely, conditional operators convert physical</span>
<span class="sd">    coordinates into abstract coordinates.</span>

<span class="sd">    .. image:: ../assets/img/user_guide_abs2phy.png</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 추상 좌표를 물리 좌표로 변환하는 클래스, 조건부연산은 역변환을</span>
<span class="sd">    수행한다.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">master</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;laygo2.Grid or laygo2.OneDimGrid: Coordinate system to which </span>
<span class="sd">    _AbsToPhyGridConverter object belongs.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180]) </span>
<span class="sd">    &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0]) </span>
<span class="sd">    &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y) </span>
<span class="sd">    &gt;&gt;&gt; print(g1_x.abs2phy) </span>
<span class="sd">    &lt;laygo2.object.grid._AbsToPhyGridConverter object&gt; </span>
<span class="sd">    &gt;&gt;&gt; print(g2.xy) </span>
<span class="sd">    &lt;laygo2.object.grid._AbsToPhyGridConverter object&gt;</span>
<span class="sd">    &gt;&gt;&gt; print(g1_x.abs2phy.master) </span>
<span class="sd">    &lt;laygo2.object.grid.OneDimGrid object&gt;</span>
<span class="sd">    &gt;&gt;&gt; print(g2.xy.master) </span>
<span class="sd">    &lt;laygo2.object.grid.Grid object&gt;</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** _AbsToPhyGridConverter 객체가 속한 좌표계.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constructor</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor function of _AbsToPhyGridConverter class.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span>

    <span class="c1"># Access functions.</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates of the master grid into corresponding</span>
<span class="sd">        physical coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0,30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy(0)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; g2.xy(0,0)</span>
<span class="sd">        [0, 0]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_call.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 대응되는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates of the master grid into corresponding</span>
<span class="sd">        physical coordinates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy(0)</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; g2.xy(0,0)</span>
<span class="sd">        [0, 0]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_getitem.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 대응되는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_2d</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_getitem_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An internal function of __getitem__() for 1-d grids.&quot;&quot;&quot;</span>
        <span class="c1"># Check if pos has multiple elements.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">_conv_slice_to_list</span><span class="p">(</span><span class="n">slice_obj</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">stop_def</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;_AbsToPhyConverter._getitem_1d does not accept None as its input.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># pos is a single element. Compute quotient and modulo for grid extension.</span>
            <span class="n">quo</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">mod</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">pos</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pos</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">quo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">pos</span> <span class="o">-</span> <span class="n">mod</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mod</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pos</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">quo</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">pos</span> <span class="o">-</span> <span class="n">mod</span><span class="p">))</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">quo</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">mod</span><span class="p">]</span>
            <span class="c1"># the following command cannot handle the size extension of the grid, disabled.</span>
            <span class="c1"># return self.master.elements.take(pos, mode=&#39;wrap&#39;)</span>

    <span class="k">def</span> <span class="nf">_getitem_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An internal function of __getitem__() for 2-d grids.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>  <span class="c1"># single point</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>  <span class="c1"># single point</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
        <span class="c1"># compute coordinates from OneDimGrids of its master.</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="c1"># TODO: Refactor the following code to avoid the use of double for loops and list comprehensions.</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>  <span class="c1"># x and y are scalars.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># x is a scalar.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">_y</span><span class="p">])</span> <span class="k">for</span> <span class="n">_y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># y is a scalar.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xy</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_x</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>  <span class="c1"># vectorize this operation.</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">_y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_x</span><span class="p">,</span> <span class="n">_y</span><span class="p">]))</span>
                <span class="n">xy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>

    <span class="c1"># Reverse-access operators (comparison operators are used for reverse-access).</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into abstract coordinates of the master grid</span>
<span class="sd">        satisfying conditional operations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy == 35</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; g2.xy == [35, 35]</span>
<span class="sd">        [1, None]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_eq.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 조건부 연산을 만족하는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">phy2abs</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into abstract coordinates of the master grid</span>
<span class="sd">        satisfying conditional operations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy &lt; 35</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &lt; [35, 35]</span>
<span class="sd">        [0, 1]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_lt.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 조건부 연산을 만족하는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lt_1d</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lt_2d</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_phy2abs_operator</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">phy2abs</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">quo_coarce</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">x</span> <span class="o">//</span> <span class="n">width</span>
                <span class="n">msb_sub</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">quo_coarce</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">+</span> <span class="n">x</span> <span class="o">//</span> <span class="n">width</span>
                <span class="n">msb_sub</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">remain</span> <span class="o">=</span> <span class="n">x</span> <span class="o">%</span> <span class="n">width</span>  <span class="c1"># positive</span>
            <span class="n">msb</span> <span class="o">=</span> <span class="n">quo_coarce</span> <span class="o">*</span> <span class="n">shape</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="n">elements</span><span class="p">):</span>
                <span class="c1"># print(&quot;e: %d r:%d, m:%d, i:%d off:%d phy:%d &quot; %(e, remain, msb + i[0], i[0], lsb_offset, quo_coarce*width + e   ))</span>
                <span class="c1"># print(comp( e , remain ))</span>

                <span class="k">if</span> <span class="n">comp</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">remain</span><span class="p">)</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># find maximum less then remain , e &lt; r</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># when it is False, latest true index</span>
                    <span class="k">return</span> <span class="n">msb</span> <span class="o">+</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">lsb_offset</span>

            <span class="k">return</span> <span class="n">msb</span> <span class="o">+</span> <span class="n">shape</span> <span class="o">+</span> <span class="n">lsb_offset</span>

        <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">:</span>  <span class="c1">## max lesser</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">r</span>
            <span class="n">lsb_offset</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span>  <span class="c1">## eq or max lesser eq</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">e</span> <span class="o">&lt;=</span> <span class="n">r</span>
            <span class="n">lsb_offset</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>  <span class="c1">## min greater</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">e</span> <span class="o">&lt;=</span> <span class="n">r</span>
            <span class="n">lsb_offset</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span>  <span class="c1">## eq or min greater</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="n">e</span> <span class="o">&lt;</span> <span class="n">r</span>
            <span class="n">lsb_offset</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">phy2abs</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list_return</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">:</span>
                <span class="n">list_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">phy2abs</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">list_return</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_lt_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phy2abs_operator</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_lt_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_lt_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into abstract coordinates of the master grid</span>
<span class="sd">        satisfying conditional operations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0,30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy &lt;= 35</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &lt;= [35,35]</span>
<span class="sd">        [1,1]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_le.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 조건부 연산을 만족하는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_le_1d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_le_2d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_le_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phy2abs_operator</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_le_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_le_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into abstract coordinates of the master grid</span>
<span class="sd">        satisfying conditional operations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy &gt; 35</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &gt; [35, 35]</span>
<span class="sd">        [2, 2]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_gt.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 조건부 연산을 만족하는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gt_1d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gt_2d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_gt_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phy2abs_operator</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;&gt;&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_gt_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_gt_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into abstract coordinates of the master grid</span>
<span class="sd">        satisfying conditional operations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0,30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.abs2phy &gt;= 35</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &gt;= [35, 35]</span>
<span class="sd">        [1, 2]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_AbsToPhyGridConverter_ge.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 조건부 연산을 만족하는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ge_1d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ge_2d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ge_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_phy2abs_operator</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_ge_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_ge_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>


<span class="k">class</span> <span class="nc">_PhyToAbsGridConverter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class that converts physical coordinates into abstract coordinates.</span>
<span class="sd">    Conversely, conditional operators convert abstract coordinates into</span>
<span class="sd">    physical coordinates.</span>

<span class="sd">    .. image:: ../assets/img/user_guide_phy2abs.png</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)**</span>
<span class="sd">    물리 좌표를 추상 좌표로 변환하는 클래스, 조건부연산은 반대로 추상 좌표를</span>
<span class="sd">    물리 좌표로 변환한다.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">master</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;laygo2.Grid or laygo2.OneDimGrid: Coordinate system to which </span>
<span class="sd">    _PhyToAbsGridConverter object belongs.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180]) </span>
<span class="sd">    &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0]) </span>
<span class="sd">    &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y) </span>
<span class="sd">    &gt;&gt;&gt; print(g1_x.phy2abs) </span>
<span class="sd">    &lt;laygo2.object.grid._PhyToAbsGridConverter object&gt; </span>
<span class="sd">    &gt;&gt;&gt; print(g2.mn) </span>
<span class="sd">    &lt;laygo2.object.grid._PhyToAbsGridConverter object&gt;</span>
<span class="sd">    &gt;&gt;&gt; print(g1_x.phy2abs.master) </span>
<span class="sd">    &lt;laygo2.object.grid.OneDimGrid object&gt;</span>
<span class="sd">    &gt;&gt;&gt; print(g2.mn.master) </span>
<span class="sd">    &lt;laygo2.object.grid.Grid object&gt;</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** _PhyToAbsGridConverter 객체가 속한 좌표계.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Constructor</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor function of _PhyToAbsGridConverter class.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">master</span> <span class="o">=</span> <span class="n">master</span>

    <span class="c1"># Access functions.</span>
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into the corresponding abstract coordinates of</span>
<span class="sd">        the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs(35)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; g2.mn([[35, 35]])</span>
<span class="sd">        [1, None]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_call.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 대응되는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert physical coordinates into the corresponding abstract coordinates of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pos : int</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs(35)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; g2.mn( [[35, 35]])</span>
<span class="sd">        [1, None]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_getItem.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 물리 좌표를 master 좌표계에서 대응되는 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_2d</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_getitem_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An internal function of __getitem__() for 1-d grids.&quot;&quot;&quot;</span>
        <span class="c1"># Check if pos has multiple elements.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">_conv_slice_to_list</span><span class="p">(</span><span class="n">slice_obj</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">stop_def</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_getitem_1d</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;_AbsToPhyConverter._getitem_1d does not accept None as its input.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># pos is a single element.</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">ndenumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">pos</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">pos</span> <span class="o">-</span> <span class="n">e</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">width</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># no matched coordinate</span>

    <span class="k">def</span> <span class="nf">_getitem_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;An internal function of __getitem__() for 2-d grid.&quot;&quot;&quot;</span>
        <span class="c1"># If pos contains multiple coordinates (or objects), convert recursively.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>  <span class="c1"># It&#39;s actually a single coordinate.</span>
                <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>  <span class="c1"># It&#39;s actually a single coordinate.</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pos</span><span class="p">])</span>
        <span class="c1"># If pos contains only one physical object, convert its bounding box to abstract coordinates</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
        <span class="c1"># If pos contains only one coordinate, convert it to abstract grid.</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># refactor the following code to avoid the use of double for-loops and list comprehensions.</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>  <span class="c1"># x and y are scalars.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># x is a scalar.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">_n</span><span class="p">])</span> <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="n">n</span><span class="p">])</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>  <span class="c1"># y is a scalar.</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_m</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span> <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">m</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mn</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">_m</span> <span class="ow">in</span> <span class="n">m</span><span class="p">:</span>  <span class="c1"># vectorize this operation.</span>
                <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">_n</span> <span class="ow">in</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_m</span><span class="p">,</span> <span class="n">_n</span><span class="p">]))</span>
                <span class="n">mn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mn</span><span class="p">)</span>

    <span class="c1"># Reverse-access operators (comparison operators are used for reverse-access).</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates into physical coordinates satisfying</span>
<span class="sd">        conditional operations in the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs == 1</span>
<span class="sd">        35</span>
<span class="sd">        &gt;&gt;&gt; g2.mn == [1, 1]</span>
<span class="sd">        [35, 30]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_eq.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 조건부 연산을 만족하는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if (self.master.__class__.__name__ == &#39;OneDimGrid&#39;) or (issubclass(self.master.__class__, OneDimGrid)):</span>
<span class="sd">            return self._eq_1d(other=other)</span>
<span class="sd">        if (self.master.__class__.__name__ == &#39;Grid&#39;) or (issubclass(self.master.__class__, Grid)):</span>
<span class="sd">            return self._eq_2d(other=other)</span>

<span class="sd">    def _eq_1d(self, other):</span>
<span class="sd">        return self._getitem_1d(pos=other)</span>

<span class="sd">    def _eq_2d(self, other):</span>
<span class="sd">        # If other is a physical object, convert its bounding box to abstract coordinates.</span>
<span class="sd">        if (other.__class__.__name__ == &#39;PhysicalObject&#39;) or (issubclass(other.__class__, laygo2.object.PhysicalObject)):</span>
<span class="sd">            mn0 = self.master &gt;= other.bbox[0]</span>
<span class="sd">            mn1 = self.master &lt;= other.bbox[1]</span>
<span class="sd">            return np.array([mn0, mn1])</span>
<span class="sd">        if isinstance(other[0], (int, np.integer)):</span>
<span class="sd">            return np.array([self.master.m[other[0]],</span>
<span class="sd">                             self.master.n[other[1]]])</span>
<span class="sd">        else:</span>
<span class="sd">            return np.array([self._eq_2d(o) for o in other])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates into physical coordinates satisfying</span>
<span class="sd">        conditional operations in the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs &lt; 1</span>
<span class="sd">        0</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &lt; [1, 1]</span>
<span class="sd">        [0, 0]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_lt.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 조건부 연산을 만족하는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lt_1d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lt_2d</span><span class="p">(</span><span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_lt_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_lt_1d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_lt_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_lt_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates into physical coordinates satisfying</span>
<span class="sd">        conditional operations in the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs &lt;= 1</span>
<span class="sd">        35</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &lt;= [1, 1]</span>
<span class="sd">        [35, 30]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_le.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 조건부 연산을 만족하는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates into physical coordinates satisfying</span>
<span class="sd">        conditional operations in the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs &gt; 1</span>
<span class="sd">        85</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &gt; [1, 1]</span>
<span class="sd">        [85, 60]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_gt.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 조건부 연산을 만족하는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;OneDimGrid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">OneDimGrid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gt_1d</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;Grid&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">Grid</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_gt_2d</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_gt_1d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_gt_1d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_gt_2d</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">integer</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="p">(</span><span class="n">other</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">other</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_gt_2d</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">other</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert abstract coordinates into physical coordinates satisfying</span>
<span class="sd">        conditional operations in the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : int</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int or numpy.ndarray</span>
<span class="sd">            physical coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 180])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 30], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; g1_x.phy2abs &gt;= 1</span>
<span class="sd">        35</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &gt;=[1, 1]</span>
<span class="sd">        [35, 30]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_ge.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 추상 좌표를 master 좌표계에서 조건부 연산을 만족하는 물리 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the bounding box of the object into the abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.bbox(rect0)</span>
<span class="sd">        [[0, 0] , [4, 4]]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.bbox(rect0)</span>
<span class="sd">        [[0, 0] , [4, 4]]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_bbox.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 bounding box를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        _AbsToPhyGridConverter 객체의 &gt;=, &lt;=를 사용하므로 추상면적이 작아질수있다.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">bbox</span>

        <span class="c1"># phy -&gt; abs</span>
        <span class="n">mn0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span> <span class="o">&gt;=</span> <span class="n">obj</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1">## ge than lower left</span>
        <span class="n">mn1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">## le than upper right\</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">mn0</span><span class="p">,</span> <span class="n">mn1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">bottom_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s physical corner coordinates into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;test&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.bottom_left(rect0)</span>
<span class="sd">        [0, 0]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.bottom_left(rect0)</span>
<span class="sd">        [0, 0]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_bottom_left.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 물리 코너 좌표를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_left</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">bottom_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s physical corner coordinates into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.bottom_right(rect0)</span>
<span class="sd">        [4, 0]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.bottom_right(rect0)</span>
<span class="sd">        [4, 0]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_bottom_right.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 물리 코너 좌표를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bottom_right</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

    <span class="k">def</span> <span class="nf">top_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s physical corner coordinates into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.top_left(rect0)</span>
<span class="sd">        [0, 4]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.top_left(rect0)</span>
<span class="sd">        [0, 4]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_top_left.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 물리 코너 좌표를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_left</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

    <span class="k">def</span> <span class="nf">top_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s physical corner coordinates into abstract</span>
<span class="sd">        coordinates of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.top_right(rect0)</span>
<span class="sd">        [4, 4]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.top_right(rect0)</span>
<span class="sd">        [4, 4]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_top_right.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 물리 코너 좌표를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">top_right</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the width of an object on this grid.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the height of an object on this grid.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PhysicalObject&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">issubclass</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__class__</span><span class="p">,</span> <span class="n">laygo2</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">PhysicalObject</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">bbox</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">height_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray(dtype=int): Return np.array([0, height]).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">obj</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">width_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray(dtype=int): Return np.array([width, 0]).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s size ([width, height]) into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.size(rect0)</span>
<span class="sd">        [4, 4]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.size(rect0)</span>
<span class="sd">        [4, 4]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_size.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 크기([width, height])를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">(</span><span class="n">obj</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">(</span><span class="n">obj</span><span class="p">)])</span>

    <span class="k">def</span> <span class="nf">crossing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the physical intersections of objects into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : laygo2.Physical</span>
<span class="sd">            physical object having bbox.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray(int, int)</span>
<span class="sd">            abstract points.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 10], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg’, scope=[0, 120], elements=[0, 20, 40, 80, 100, 120])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0= physical.Rect(xy=[[0, 0], [60, 90]])</span>
<span class="sd">        &gt;&gt;&gt; rect1= physical.Rect(xy=[[30, 30], [120, 120]])</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.crossing(rect0, rect1)</span>
<span class="sd">        [3, 2]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.crossing(rect0, rect1)</span>
<span class="sd">        [3, 2]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_crossing.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체들의 물리적 교차점을 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;point&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bbox&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the overlapping area of objects into abstract coordinates of</span>
<span class="sd">        the master grid and return in a format specified in type.</span>

<span class="sd">        A bounding box is returned if type=&#39;bbox&#39;</span>

<span class="sd">        All coordinates in the overlapped region are returned in a</span>
<span class="sd">        two-dimensional array if type=&#39;array&#39;</span>

<span class="sd">        An one-dimensional list is returned if type=&#39;list&#39;.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : laygo2.Physical</span>
<span class="sd">            physical object having bbox.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            bbox abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xg&#39;, scope=[0, 10], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;yg&#39;, scope=[0, 120], elements=[0, 20, 40, 80, 100, 120])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&#39;g&#39;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0= physical.Rect(xy=[[0, 0], [60, 90]])</span>
<span class="sd">        &gt;&gt;&gt; rect1= physical.Rect(xy=[[30, 30], [120, 120]])</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.overlap(rect0, rect1)</span>
<span class="sd">        [[3, 2], [6,4]]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.overlap(rect0, rect1)</span>
<span class="sd">        [[3, 2], [6,4]]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_overlap.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체들의 겹치는 면적을 master 좌표계의 추상 좌표로 변환 후</span>
<span class="sd">        type에 따른 형태로 반환.</span>

<span class="sd">        &#39;bbox&#39;인 경우, bounding box로 반환.</span>

<span class="sd">        &#39;array&#39; 인 경우 모든 교점을 2차원 array로 반환.</span>

<span class="sd">        &#39;list&#39; 인경우 모든 교점을 1차원 list로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_ib</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">_obj</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_ib</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_ib</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">_obj</span><span class="p">)</span>  <span class="c1">## shaped</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">_obj</span><span class="p">)</span>
                <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_b</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">_ib</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_b</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">_ib</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">_ib</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">_x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">_y</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">_x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_y</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;bbox&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_ib</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;point&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_ib</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;list&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_conv_bbox_to_list</span><span class="p">(</span><span class="n">_ib</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_conv_bbox_to_array</span><span class="p">(</span><span class="n">_ib</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;overlap() should receive a valid value for its type (bbox, point, array, ...)&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the bounding box containing all objects into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : laygo2.Physical</span>
<span class="sd">            physical object having bbox.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numpy.ndarray</span>
<span class="sd">            bbox abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 10], elements=[0])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 120], elements=[0, 20, 40, 80, 100, 120 )</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; rect0= physical.Rect(xy=[[0, 0], [60, 90]])</span>
<span class="sd">        &gt;&gt;&gt; rect1= physical.Rect(xy=[[30, 30], [120, 120]])</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.union(rect0, rect1)</span>
<span class="sd">        [[0, 0], [12,7]]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_union.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체들을 모두 포함하는 bounding box를 master 좌표계의</span>
<span class="sd">        추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_ub</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">_obj</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">_ub</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">_ub</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">_obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">_obj</span><span class="p">)</span>
                <span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_b</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">_ub</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">_b</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">_ub</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]]),</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                <span class="n">_ub</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">_x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">_y</span><span class="p">[</span><span class="mi">3</span><span class="p">]]])</span>
        <span class="k">return</span> <span class="n">_ub</span>

    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert an object&#39;s physical center coordinates into abstract coordinates</span>
<span class="sd">        of the master grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.physical</span>
<span class="sd">            object having physical coordinate.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        numy.ndarray</span>
<span class="sd">            abstract coordinates.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x    = OneDimGrid(name=&#39;xg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g1_y    = OneDimGrid(name=&#39;yg&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2      = Grid(name=&#39;g&#39;, vgrid=g1_x, hgrid=g1_y)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs = _PhyToAbsGridConverter(master=g2)</span>
<span class="sd">        &gt;&gt;&gt; rect0 = physical.Rect(xy=[[0, 0], [100, 100]], layer=[&#39;M1&#39;, &#39;drawing&#39;], netname=&#39;net0’)</span>
<span class="sd">        &gt;&gt;&gt; phy2abs.center(rect0)</span>
<span class="sd">        [3, 3]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn.center(rect0)</span>
<span class="sd">        [3, 3]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_PhyToAbsGridConverter_center.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 객체의 물리 중앙 좌표를 master 좌표계의 추상 좌표로 변환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mn0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span> <span class="o">&gt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">center</span>
        <span class="n">mn1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span> <span class="o">&lt;=</span> <span class="n">obj</span><span class="o">.</span><span class="n">center</span>

        <span class="n">point_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">mn0</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">mn1</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">mn0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mn1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">xy</span><span class="p">[</span><span class="n">mn1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">mn0</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="p">]</span>  <span class="c1"># 4 physical points near the center coordinate.</span>
        <span class="n">dist_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">point_list</span><span class="p">:</span>
            <span class="n">dist_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">idx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">point</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">center</span><span class="p">)])</span>  <span class="c1"># Calculate Euclidean distances.</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">dist_sorted</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dist_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">distance</span><span class="p">:</span> <span class="n">distance</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># Sort distances in ascending order.</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">master</span><span class="o">.</span><span class="n">mn</span><span class="p">(</span>
            <span class="n">point_list</span><span class="p">[</span><span class="n">dist_sorted</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="p">)</span>  <span class="c1"># Convert the closest point to abstract coordinate and then return.</span>


<div class="viewcode-block" id="OneDimGrid"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid">[docs]</a><span class="k">class</span> <span class="nc">OneDimGrid</span><span class="p">(</span><span class="n">CircularMapping</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class implementing one-dimensional abstract coordinates.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)**</span>
<span class="sd">    1차원 추상좌표를 구현하는 클래스.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Member variables and properties</span>
    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;str: Coordinate system name.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50]) </span>
<span class="sd">    &gt;&gt;&gt; g1_x.name</span>
<span class="sd">    &quot;xgrid&quot;</span>

<span class="sd">    .. image:: ../assets/img/object_grid_OneDimGrid_name.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 좌표계 이름.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">range</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;str: Region in which the coordinate system is defined Coordinates in </span>
<span class="sd">    the defined region are repeatedly expanded.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50]) </span>
<span class="sd">    &gt;&gt;&gt; g1_x.range</span>
<span class="sd">    [0, 180]</span>
<span class="sd">    </span>
<span class="sd">    .. image:: ../assets/img/object_grid_OneDimGrid_range.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 좌표계가 정의된 영역. 정의된 영역의 좌표들이 반복되는 형태로 확장된다.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">phy2abs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;self.phy2abs (laygo2._PhyToAbsGridConverter): Object that converts physical </span>
<span class="sd">    coordinates into abstract coordinates.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">    &gt;&gt;&gt; g1_x  = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50]) </span>
<span class="sd">    &gt;&gt;&gt; g1_x.phy2abs</span>
<span class="sd">    &lt;_PhyToAbsGridConverter object&gt;</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 물리 좌표에서 추상 좌표로 변환연산을 해주는 객체. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">abs2phy</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;self.abs2phy (laygo2._AbsToPhyGridConverter): Object that converts abstract </span>
<span class="sd">    coordinates into physical coordinates.</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50]) </span>
<span class="sd">    &gt;&gt;&gt; g1_x.abs2phy</span>
<span class="sd">    &lt;_AbsToPhyGridConverter object&gt;</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 추상 좌표에서 물리 좌표로 변환연산을 해주는 객체. </span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;int: The size of the region in which the coordinate system is defined.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50])</span>
<span class="sd">        &gt;&gt;&gt; g1_x.width</span>
<span class="sd">        180</span>

<span class="sd">        .. image:: ../assets/img/object_grid_OneDimGrid_width.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 좌표계가 정의된 영역의 크기.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Constructor</span>
<div class="viewcode-block" id="OneDimGrid.__init__"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">scope</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor function of OneDimGrid class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">        scope : numpy.ndarray</span>
<span class="sd">            scope of one-dimensional coordinate system</span>
<span class="sd">        elements: numpy.ndarray</span>
<span class="sd">            members of one-dimensional coordinate system</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        laygo2.OneDimGrid</span>



<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50])</span>
<span class="sd">        &gt;&gt;&gt; print(g1_x)</span>
<span class="sd">        OneDimGrid object name: xgrid, class: OneDimGrid, scope: [0, 180], elements: [0, 35, 85, 130  50]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_OneDimGrid_init.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** OneDimGrid 클래스의 생성자함수.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span> <span class="o">=</span> <span class="n">_PhyToAbsGridConverter</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span> <span class="o">=</span> <span class="n">_AbsToPhyGridConverter</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">CircularMapping</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elements</span><span class="o">=</span><span class="n">elements</span><span class="p">)</span></div>
        <span class="c1"># self.elements = np.asarray(elements)  # commented out because asarray does not woke well with Object arrays.</span>

    <span class="c1"># Indexing and slicing functions</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the physical coordinate corresponding to the abstract coordinate pos.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="p">([</span><span class="n">pos</span><span class="p">])</span>

    <span class="c1"># Comparison operators</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the abstract grid coordinate that matches to other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the abstract grid coordinate that is the largest but less than other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the largest but less than or equal to other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the abstract grid coordinate that is the smallest but greater than other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the smallest but greater than or equal to other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="c1"># Informative functions</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the string representation of the object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize</span><span class="p">()</span>

<div class="viewcode-block" id="OneDimGrid.summarize"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.summarize">[docs]</a>    <span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the summary of the object information.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
            <span class="s2">&quot;name: &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
            <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;class: &quot;</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;scope: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">)</span>
            <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
            <span class="o">+</span> <span class="s2">&quot;elements: &quot;</span>
            <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span>
        <span class="p">)</span></div>

    <span class="c1"># I/O functions</span>
<div class="viewcode-block" id="OneDimGrid.export_to_dict"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.export_to_dict">[docs]</a>    <span class="k">def</span> <span class="nf">export_to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return dict object containing grid information.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 180], elements=[0, 35, 85, 130, 50])</span>
<span class="sd">        &gt;&gt;&gt; g1_x.export_to_dict()</span>
<span class="sd">        {&#39;scope&#39;: [0, 180], &#39;elements&#39;: [0, 35, 85, 130, 50]}</span>

<span class="sd">        .. image:: ../assets/img/object_grid_OneDimGrid_export_to_dict.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 그리드의 정보를 담은 dict객체 반환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">export_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;scope&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
            <span class="s2">&quot;elements&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">export_dict</span></div>
    
<div class="viewcode-block" id="OneDimGrid.flip"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.flip">[docs]</a>    <span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Flip the elements of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># self.elements = self.range[1]*np.ones(self.elements.shape) - np.flip(self.elements) + self.range[0]*np.ones(self.elements.shape) </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="OneDimGrid.copy"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Copy the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">OneDimGrid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">elements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span></div>

<div class="viewcode-block" id="OneDimGrid.concatenate"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.OneDimGrid.concatenate">[docs]</a>    <span class="k">def</span> <span class="nf">concatenate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="n">objelem</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">elements</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">objelem</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">obj</span><span class="o">.</span><span class="n">range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div></div>
        <span class="c1">#for e in elements:</span>
        <span class="c1">#    self.elements = np.concatenate((self.elements, obj.elements))</span>
        <span class="c1">#self.range[1] += obj.range[1] - obj.range[0]</span>


<div class="viewcode-block" id="Grid"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid">[docs]</a><span class="k">class</span> <span class="nc">Grid</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A base class having conversion operators and the mapping information (element)</span>
<span class="sd">    between two-dimensional physical coordinates and abstract coordinates.</span>

<span class="sd">    Examplar grid conversions between abstract and physical coordinates are</span>
<span class="sd">    summarized in the following figure.</span>

<span class="sd">    .. image:: ../assets/img/user_guide_grid_conversion.png</span>


<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 2차원 물리좌표와 추상좌표간 mapping 정보(element) 를 갖고 있으며</span>
<span class="sd">    해당 element를 활용하는 좌표 연산자를 가지고 있는 기본 클래스.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;str: the name of the grid.&quot;&quot;&quot;</span>

    <span class="n">_xy</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;List[OneDimGrid]: the list contains the 1d-grid objects for x and y axes.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="Grid._get_vgrid"><a class="viewcode-back" href="../../../../laygo2.object.grid.Grid.html#laygo2.object.grid.Grid._get_vgrid">[docs]</a>    <span class="k">def</span> <span class="nf">_get_vgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Grid._set_vgrid"><a class="viewcode-back" href="../../../../laygo2.object.grid.Grid.html#laygo2.object.grid.Grid._set_vgrid">[docs]</a>    <span class="k">def</span> <span class="nf">_set_vgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

    <span class="n">vgrid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_vgrid</span><span class="p">,</span> <span class="n">_set_vgrid</span><span class="p">)</span>

<div class="viewcode-block" id="Grid._get_hgrid"><a class="viewcode-back" href="../../../../laygo2.object.grid.Grid.html#laygo2.object.grid.Grid._get_hgrid">[docs]</a>    <span class="k">def</span> <span class="nf">_get_hgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>
    
<div class="viewcode-block" id="Grid._set_hgrid"><a class="viewcode-back" href="../../../../laygo2.object.grid.Grid.html#laygo2.object.grid.Grid._set_hgrid">[docs]</a>    <span class="k">def</span> <span class="nf">_set_hgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

    <span class="n">hgrid</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">_get_hgrid</span><span class="p">,</span> <span class="n">_set_hgrid</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: Two-dimensional element of a coordinate system.</span>
<span class="sd">            x elements, y elements</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.elements</span>
<span class="sd">        [ array([0, 10, 20, 40, 50]), array( [10, 20, 40, 50, 60] ) ]</span>

<span class="sd">        .. image:: ../assets/img/object_grid_Grid_Elements.png</span>
<span class="sd">           :height: 250</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 좌표계 2차원 element.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>

    <span class="n">phy2abs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;PhyToAbsGridConverter(master=self)&quot;&quot;&quot;</span>

    <span class="n">abs2phy</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="sd">&quot;&quot;&quot;AbsToPhyGridConverter(master=self)&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_AbsToPhyGridConverter: Two-dimensional</span>
<span class="sd">        _AbsToPhyConverter of a coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.xy[10,10]</span>
<span class="sd">        [200 210]</span>
<span class="sd">        &gt;&gt;&gt; g2.xy([10, 10])</span>
<span class="sd">        [200 210]</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &lt; [10,10]</span>
<span class="sd">        [0,-1]</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &lt;= [10,10]</span>
<span class="sd">        [1,0]</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &gt; [10,10]</span>
<span class="sd">        [2,1]</span>
<span class="sd">        &gt;&gt;&gt; g2.xy &gt;= [10,10]</span>
<span class="sd">        [1,0]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 2차원 _AbsToPhyConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_AbsToPhyGridConverter: One-dimensional _AbsToPhyGridConverter</span>
<span class="sd">            of the x-coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.x[10]</span>
<span class="sd">        200</span>
<span class="sd">        &gt;&gt;&gt; g2.x &lt;  10</span>
<span class="sd">        [0]</span>
<span class="sd">        &gt;&gt;&gt; g2.x &lt;= 10</span>
<span class="sd">        [1]</span>
<span class="sd">        &gt;&gt;&gt; g2.x &gt;  10</span>
<span class="sd">        [2]</span>
<span class="sd">        &gt;&gt;&gt; g2.x &gt;= 10</span>
<span class="sd">        [1]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)**</span>
<span class="sd">        x좌표계 1차원 _AbsToPhyGridConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abs2phy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_AbsToPhyGridConverter: One-dimensional _AbsToPhyGridConverter</span>
<span class="sd">        of the y-coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.y[10]</span>
<span class="sd">        210</span>
<span class="sd">        &gt;&gt;&gt; g2.y &lt;  10</span>
<span class="sd">        [-1]</span>
<span class="sd">        &gt;&gt;&gt; g2.y &lt;= 10</span>
<span class="sd">        [0]</span>
<span class="sd">        &gt;&gt;&gt; g2.y &gt;  10</span>
<span class="sd">        [1]</span>
<span class="sd">        &gt;&gt;&gt; g2.y &gt;= 10</span>
<span class="sd">        [0]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** y좌표계 1차원 _AbsToPhyGridConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">abs2phy</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">v</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;OneDimGrid: OneDimGrid of the x-coordinate system (=self.x).</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.v</span>
<span class="sd">        g1_x</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** x좌표계 OneDimGrid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;OneDimGrid: OneDimGrid of the y-coordinate system (=self.y).</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.h</span>
<span class="sd">        g1_y</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** y좌표계 OneDimGrid.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;laygo2._PhyToAbsGridConverter: Two-dimensional _PhyToAbsConverter of</span>
<span class="sd">        a coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.mn[40,40]</span>
<span class="sd">        [3, 2]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn([40, 40])</span>
<span class="sd">        [3, 2]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &lt;  [40,40]</span>
<span class="sd">        [750, 760]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &lt;= [40,40]</span>
<span class="sd">        [800, 810]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &gt;  [40,40]</span>
<span class="sd">        [810, 820]</span>
<span class="sd">        &gt;&gt;&gt; g2.mn &gt;= [40,40]</span>
<span class="sd">        [800, 810]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)**</span>
<span class="sd">        좌표계 2차원 _PhyToAbsConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_PhyToAbsGridConverter: One-dimensional _PhyToAbsConverter of</span>
<span class="sd">        the x-coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.n[40]</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; g2.n(40)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; g2.n &lt;  40</span>
<span class="sd">        760</span>
<span class="sd">        &gt;&gt;&gt; g2.n &lt;= 40</span>
<span class="sd">        810</span>
<span class="sd">        &gt;&gt;&gt; g2.n &gt;  40</span>
<span class="sd">        820</span>
<span class="sd">        &gt;&gt;&gt; g2.n &gt;= 40</span>
<span class="sd">        810</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** x좌표계 1차원 _PhyToAbsConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">phy2abs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;_PhyToAbsGridConverter: One-dimensional _PhyToAbsConverter of</span>
<span class="sd">         the y-coordinate system.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.n[40]</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; g2.n(40)</span>
<span class="sd">        2</span>
<span class="sd">        &gt;&gt;&gt; g2.n &lt;  40</span>
<span class="sd">        760</span>
<span class="sd">        &gt;&gt;&gt; g2.n &lt;= 40</span>
<span class="sd">        810</span>
<span class="sd">        &gt;&gt;&gt; g2.n &gt;  40</span>
<span class="sd">        820</span>
<span class="sd">        &gt;&gt;&gt; g2.n &gt;= 40</span>
<span class="sd">        810</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** y좌표계 1차원 _PhyToAbsConverter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">phy2abs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: Two-dimensional element length in a coordinate system.</span>
<span class="sd">            length of x-axis elements, length of y-axis elements</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.shape</span>
<span class="sd">        [5, 5]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 좌표게 2차원 element의 길이.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">])</span>

<div class="viewcode-block" id="Grid.get_range"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.get_range">[docs]</a>    <span class="k">def</span> <span class="nf">get_range</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">range</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Grid.set_range"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.set_range">[docs]</a>    <span class="k">def</span> <span class="nf">set_range</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">value</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span></div>

    <span class="nb">range</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_range</span><span class="p">,</span> <span class="n">set_range</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;numpy.ndarray: Region in which the coordinate system is defined.</span>
<span class="sd">        bbox of the respective Grid</span>

<span class="sd">    Example</span>
<span class="sd">    -------</span>
<span class="sd">    &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">    &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ]) </span>
<span class="sd">    &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ]) </span>
<span class="sd">    &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">    &gt;&gt;&gt; g2.range </span>
<span class="sd">    [ [0, 0], [100, 100 ]]</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    **(Korean)** 좌표계가 정의된 영역.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.int32: Width of the region in which the coordinate system is defined.</span>
<span class="sd">            x scope</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.width</span>
<span class="sd">        100</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 좌표계가 정의된 영역의 폭.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.int32: Height of the region in which the coordinate system is defined.</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.height</span>
<span class="sd">        100</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 좌표계가 정의된 영역의 높이.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">width</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">height_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: Return the height vector [0, h].</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.height_vec</span>
<span class="sd">        [0, 100]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** height를 list로 반환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">width_vec</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;numpy.ndarray: Return width as a list.</span>
<span class="sd">            length of the respective axis and zero</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.width_vec</span>
<span class="sd">        [100, 0]</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** width를 list로 반환.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">width</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<div class="viewcode-block" id="Grid.__init__"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">vgrid</span><span class="p">,</span> <span class="n">hgrid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor function of Grid class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">        vgrid : laygo2.object.grid.OndDimGrid</span>
<span class="sd">            OneDimGrid object of the x-coordinate system</span>
<span class="sd">        hgrid : laygo2.object.grid.OndDimGrid</span>
<span class="sd">            OneDimGrid object of the y-coordinate system</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        laygo2.object.grid.Grid</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; print(g2)</span>
<span class="sd">        &lt;laygo2.object.grid.Grid object&gt; name: test, class: Grid, scope: [[0, 0], [100, 100]], elements: [array([ 0, 10, 20, 40, 50]), array([10, 20, 40, 50, 60])</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** Grid 클래스의 생성자함수.</span>
<span class="sd">        파라미터</span>
<span class="sd">            - name(str): 이름</span>
<span class="sd">            - vgrid(laygo2.OneDimGrid): x좌표계 OneDimGrid 객체</span>
<span class="sd">            - hgrid(laygo2.OneDimGrid): y좌표계 OneDimGrid 객체</span>
<span class="sd">        반환값</span>
<span class="sd">            - laygo2.Grid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span> <span class="o">=</span> <span class="p">[</span><span class="n">vgrid</span><span class="p">,</span> <span class="n">hgrid</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span> <span class="o">=</span> <span class="n">_PhyToAbsGridConverter</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span> <span class="o">=</span> <span class="n">_AbsToPhyGridConverter</span><span class="p">(</span><span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;list: return elements of subgrids</span>
<span class="sd">        ([_xy[0].elements, _xy[1].elements]).</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">elements</span><span class="p">]</span>

    <span class="c1"># Indexing and slicing functions</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="c1"># Comparison operators</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the physical grid coordinate that matches to other.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the largest</span>
<span class="sd">        but less than other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the largest</span>
<span class="sd">        but less than or equal to other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the smallest</span>
<span class="sd">        but greater than other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the index of the grid coordinate that is the smallest</span>
<span class="sd">        but greater than or equal to other.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">abs2phy</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

<div class="viewcode-block" id="Grid.bbox"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.bbox">[docs]</a>    <span class="k">def</span> <span class="nf">bbox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the</span>
<span class="sd">        &#39;internal&#39; bounding box of obj.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _PhyToAbsGridConverter.bbox</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">bbox</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.bottom_left"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.bottom_left">[docs]</a>    <span class="k">def</span> <span class="nf">bottom_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the</span>
<span class="sd">        bottom-left corner of obj.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _PhyToAbsGridConverter.bottom_left</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">bottom_left</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.bottom_right"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.bottom_right">[docs]</a>    <span class="k">def</span> <span class="nf">bottom_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the</span>
<span class="sd">        bottom-right corner of obj.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _PhyToAbsGridConverter.bottom_right</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">bottom_right</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.top_left"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.top_left">[docs]</a>    <span class="k">def</span> <span class="nf">top_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the top-left</span>
<span class="sd">        corner of obj.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _PhyToAbsGridConverter.top_left</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">top_left</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.top_right"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.top_right">[docs]</a>    <span class="k">def</span> <span class="nf">top_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the top-right</span>
<span class="sd">        corner of obj.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        _PhyToAbsGridConverter.top_right</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">top_right</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.crossing"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.crossing">[docs]</a>    <span class="k">def</span> <span class="nf">crossing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the crossing</span>
<span class="sd">        point of args.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        laygo2.object.grid._PhyToAbsGridConverter.crossing</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">crossing</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.overlap"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.overlap">[docs]</a>    <span class="k">def</span> <span class="nf">overlap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;bbox&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the overlap</span>
<span class="sd">        of args.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        laygo2.object.grid._PhyToAbsGridConverter.overlap</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.union"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.union">[docs]</a>    <span class="k">def</span> <span class="nf">union</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to union of args.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        laygo2.object.grid._PhyToAbsGridConverter.union</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="Grid.center"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.center">[docs]</a>    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the abstract grid coordinates corresponding to the center</span>
<span class="sd">        point of obj.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj : laygo2.object.physical.PhysicalObject</span>
<span class="sd">            The object of which center coordinate is computed.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        laygo2.object.grid._PhyToAbsGridConverter.center</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">phy2abs</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div>

    <span class="c1"># Iterators</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: fix this to iterate over the full coordinates</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="fm">__iter__</span><span class="p">()])</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO: fix this to iterate over the full coordinates</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="fm">__next__</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="fm">__next__</span><span class="p">()])</span>

    <span class="c1"># Informative functions</span>
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the string representation of the object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">summarize</span><span class="p">()</span>

<div class="viewcode-block" id="Grid.summarize"><a class="viewcode-back" href="../../../../laygo2.object.grid.core.html#laygo2.object.grid.Grid.summarize">[docs]</a>    <span class="k">def</span> <span class="nf">summarize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Output the information of the respective grid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        &gt;&gt;&gt; from laygo2.object.grid import OneDimGrid, Grid</span>
<span class="sd">        &gt;&gt;&gt; g1_x = OneDimGrid(name=&#39;xgrid&#39;, scope=[0, 100], elements=[0, 10, 20, 40, 50 ])</span>
<span class="sd">        &gt;&gt;&gt; g1_y = OneDimGrid(name=&#39;ygrid&#39;, scope=[0, 100], elements=[10, 20, 40, 50, 60 ])</span>
<span class="sd">        &gt;&gt;&gt; g2   = Grid(name=&quot;test&quot;, vgrid = g1_x, hgrid = g1_y )</span>
<span class="sd">        &gt;&gt;&gt; g2.summarize()</span>
<span class="sd">        &lt;laygo2.object.grid.Grid object&gt; name: test, class: Grid, scope: [[0, 0], [100, 100]], elements: [array([ 0, 10, 20, 40, 50]), array([10, 20, 40, 50, 60])</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        **(Korean)** 해당 Grid의 정보 출력.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; name: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; class: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; scope: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="o">+</span> <span class="s2">&quot; elements: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;, </span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span></div></div>



<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">class ParameterizedGrid(Grid):</span>
<span class="sd">    &quot;&quot;&quot;A parameterized grid to support flexible templates.&quot;&quot;&quot;</span>

<span class="sd">    # TODO: implement this.</span>
<span class="sd">    pass</span>


<span class="sd">class ParameterizedPlacementGrid(Grid):</span>
<span class="sd">    # TODO: implement this.</span>
<span class="sd">    pass</span>


<span class="sd">class ParameterizedRoutingGrid(Grid):</span>
<span class="sd">    # TODO: implement this.</span>
<span class="sd">    pass</span>
<span class="sd">&#39;&#39;&#39;</span>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Niftylab at Hanyang University, South Korea.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>